运输层协议为运行在不同主机上的**应用程序之间**提供了逻辑通信

运输层将从应用程序进程接收的报文转换为运输层分组，即称为**报文段**segment ：将**报文**划分为小块，为每个小块加上一个运输层首部生成运输层报文段

网络层（在运输层下方）提供了**主机之间**的逻辑通信

UDP **用户数据报协议**

TCP **传输控制协议**

IP **网际协议** 尽力而为交付服务 best-effort delivery service 不可靠服务 unreliable service 

**多路分解** demultiplexing 将运输层报文段中的数据交付到正确的套接字的工作

**多路复用** multiplexing 在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息从而生成报文段，再将其传递到网络层

**运输层多路复用的要求** 套接字有唯一标识符；每个报文段有特殊字段来指示该报文段所要交付到的套接字，包括源端口号字段 source port number filed 和目的端口号字段 destination port number filed 

端口号是一个16 bit的数，大小在0～65535之间，0~1023范围的端口号称为**周知段口号** well-known port number 保留给特定服务，

**无连接的多路分解和多路复用** 一个UDP套接字由一个二元组来全面标识的，该二元组包括一个目的IP地址和一个目的端口号

**面向连接的多路复用和多路分解** TCP套接字是由一个四元组（源IP地址，源端口号，目的IP地址，目的端口号）来标识的，四个都匹配才会分配到对应的套接字上，
这与UDP不同，UDP只要目的IP地址和目的端口号匹配即可

UDP校验和 （实际上在计算校验和时，除了UDP报文段以外还包括IP首段的一些字段，但是暂时忽略细节）
用于确定当UDP报文段从源到达目的地移动时，其中的比特是否发生了改变（比如由于链路中的噪声干扰或存储在路由器中时引入的问题）

- 发送方的UDP对报文段中的所有16比特字的和进行反码运算，求和时遇到的任何溢出都被回卷
- 例如，对于3个16比特字的前两个求和，结果再与第三个字相加，如果结果有溢出，则回卷。对结果求反码运算，最后的结果作为检验和
- 回卷是指当计算结果溢出时，将溢出的位添加回最高位。例如，对于16位二进制数1111111111111111（即十六进制数0xFFFF），如果向其加1，则会发生溢出，最终结果为0000000000000000，同时溢出了一个位，这个溢出的位就会被添加回最高位，也就是变成了1000000000000000（即十六进制数0x8000），这就是回卷。
- “字”在计算机术语中的英文是“word”。在不同的上下文中，“word”可能表示不同长度的数据块，例如在32位计算机中，“word”通常指32位（4字节）的数据块，而在16位计算机中，“word”通常指16位（2字节）的数据块。在UDP检验和计算中，三个16比特字指的是三个16位（2字节）的数据块。
- 在接收方，全部的4个比特字（包括检验和）加在一起，如果该分组中没有引入差错，则显然在接收方处该和将是全1的，如果有任何一个位是0，那么该分组中就出现了差错。
- UDP对差错无能为力，一种实现是丢弃有差错的报文段，另一种则将有差错的报文交给应用程序并发出警告

可靠传输原理

可靠数据传输协议 reliable data transfer protocal

下面的内容仅对于 单项数据传输 unidirectional data transfer, not directional data transfer, aka 全双工数据传输

rdt 2.0
- 差错检测 分组检验和字段
- 接收方反馈 “肯定确认” ACK acknowledgment ACK分组 1bit 1 ; “否定确认” NAK negative acknowledgment NAK分组 1bit 0
- 重传机制
- 注意：停等 stop-and-wait协议 当发送方处于等待ACK或NAK的状态时，他不能从上层获得更多数据，除非接收到ACK并离开该状态
- 缺陷：没有考虑ACK或NAK分组受损的可能

rdt 2.1
- 




